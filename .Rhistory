least.square = psi.ls,
least.abs.dev = NA,
huber = psi.huber,
hampel = psi.hampel,
tukey = psi.bisquare,
andrews = psi.andrew
)
for (M.estimator in names(M.estimators)) {
M.phi <- M.estimators[[M.estimator]]
if (M.estimator == "least.abs.dev") {
# least absolute deviation requires a different function to fit the model
model <- rq(arr_delay ~ ., data = data)
} else {
model <- rlm(arr_delay ~ ., data = data, psi = M.phi)
}
metric = mad(model$residuals) # mean absolute deviation
print(paste(M.estimator, metric, sep = ": "))
}
summary(model)
?rstandard
rstandard(model)
model <- rlm(arr_delay ~ ., data = data)
rstandard(model)
all.equalrq(arr_delay ~ ., data = data)rstandard(model)
rq(arr_delay ~ ., data = data)
rstandard(rq(arr_delay ~ ., data = data))
leverage
model.lm = lm(arr_delay ~ ., data = data)
rstandard(model.lm)
?critval
critval = qt(0.05/(2*nobs(model.lm)), df = df.residual(model.lm)-1, lower = F)
which(abs(rstudent(model.lm)) > critval)
model.lm = lm(arr_delay ~ ., data = data)
critval = qt(0.05/(2*nobs(model.lm)), df = df.residual(model.lm)-1, lower = F)
which(abs(rstudent(model.lm)) > critval)
model.lm <- lm(arr_delay ~ ., data = data)
critval <- qt(0.05/(2*nobs(model.lm)), df = df.residual(model.lm)-1, lower = F)
outliers <- which(abs(rstandard(model.lm)) > critval)
outliers
length(outliers)
model.lm <- lm(arr_delay ~ ., data = data)
critval <- qt(0.05/(2*nobs(model.lm)), df = df.residual(model.lm)-1, lower = F)
outliers <- which(abs(rstudent(model.lm)) > critval)
length(outliers)
library(car)
install.packages("car")
library(car)
outlierTest(model.lm)
outlierTest(model)
length(outlierTest(model))
dim(outlierTest(model))
outlierTest(model)
. = outlierTest(model)
.
dim(.)
nrow(.)
a = outlierTest(model)
a
outlierTest(model)
outlierTest(model.lm)
?outlier.test
?outlierTest
outlierTestlm
outlierTest(model, cufoff = 0.9)
outlierTest(model, cufoff)
outlierTest(model, n.max = NA)
outlierTest(model, n.max = 100)
length(outliers)
outlierTest(model, n.max = 200)
outlierTest(model.lm, n.max = 200)
library(car)
outlierTest(model, cutoff = 0.05, n.max = 200)
outlierTest(model, cutoff = 0.05, n.max = 200)
a=outlierTest(model, cutoff = 0.05, n.max = 200)
rownames(a)
a
model
summary(model)
summary(model)$coef
summary(model)$coef$Std.Error
summary(model)$coef["Std. Error"]
a=summary(model)$coef
a
a[1,]
a[,1]
a[,2]
print(param.sigmas)
for (M.estimator in names(M.estimators)) {
M.phi <- M.estimators[[M.estimator]]
if (M.estimator == "least.abs.dev") {
# least absolute deviation requires a different function to fit the model
model <- rq(arr_delay ~ ., data = data)
} else {
model <- rlm(arr_delay ~ ., data = data, psi = M.phi)
}
metric <- mad(model$residuals) # mean absolute deviation
param.sigmas <- summary(model)$coef[,2]
print(paste(M.estimator, metric, sep = ": "))
print(param.sigmas)
}
model
summary(model)
summary(model)
M.estimators <- c(
least.square = psi.ls,
least.abs.dev = NA,
huber = psi.huber,
hampel = psi.hampel,
tukey = psi.bisquare,
# andrews = psi.andrew
)
knitr::opts_chunk$set(echo = TRUE)
library(MASS)
library(tidyverse)
library(quantreg)
library(car)
df <-  read.csv("merged_data.csv")
data <- df[, c("arr_delay", "distance", "dep_hr", "awnd", "prcp", "snow", "tmax", "tmin")]
data <- drop_na(data)
# least squares loss
psi.ls <- function(u, deriv = 0) {
n = length(u)
return(rep(1, n))
}
# Andrews' Sine
psi.andrew <- function(u, c = 1.339, deriv = 0) {
t = u/c
if (!deriv) {
return(ifelse(abs(u)<pi*c, sin(t)/t, 0))
}
return(ifelse(abs(u)<pi*c, (u*cos(t)-c*sin(t))/u^2, 0))
}
M.estimators <- c(
least.square = psi.ls,
least.abs.dev = NA,
huber = psi.huber,
hampel = psi.hampel,
tukey = psi.bisquare
# andrews = psi.andrew
)
for (M.estimator in names(M.estimators)) {
M.phi <- M.estimators[[M.estimator]]
if (M.estimator == "least.abs.dev") {
# least absolute deviation requires a different function to fit the model
model <- rq(arr_delay ~ ., data = data)
} else {
model <- rlm(arr_delay ~ ., data = data, psi = M.phi)
}
metric <- mad(model$residuals) # mean absolute deviation
param.sigmas <- summary(model)$coef[,2]
print(paste(M.estimator, metric, sep = ": "))
print(param.sigmas)
}
a=outlierTest(model, cutoff = 0.05, n.max = 200)
summary(model)
for (M.estimator in names(M.estimators)) {
M.phi <- M.estimators[[M.estimator]]
if (M.estimator == "least.abs.dev") {
# least absolute deviation requires a different function to fit the model
model <- rq(arr_delay ~ ., data = data)
} else {
model <- rlm(arr_delay ~ ., data = data, psi = M.phi)
}
metric <- mad(model$residuals) # mean absolute deviation
params <- summary(model)$coef
print(paste(M.estimator, metric, sep = ": "))
print(params)
}
a
a=outlierTest(model, cutoff = 0.05, n.max = 200)
a=outlierTest(model, cutoff = 0.05, n.max = 200)
model
model$residuals
model.lm = lm(arr_delay ~ ., data = data)
a=outlierTest(modellm, cutoff = 0.05, n.max = 200)
a=outlierTest(model.lm, cutoff = 0.05, n.max = 200)
a
a=outlierTest(model.lm, cutoff = 0.05, n.max = 200)
a
typeof(a)
names(a)
a
a$rstudent
names(a$rstudent)
int(names(a$rstudent))
integer(names(a$rstudent))
as.integer(names(a$rstudent))
model.lm = lm(arr_delay ~ ., data = data)
outlier.test.results <- outlierTest(model.lm, cutoff = 0.05, n.max = 200)
outlier.indices <- as.integer(names(outlier.test.results$rstudent))
data.no.outliers <- data[-outlier.indices]
data[-1]
data[-2]
data[-c(-1,-1)]
data[-c(-1,-2)]
data[,-c(-1,-2)]
data[-c(-1,-2),]
data[-c(1,2),]
data.no.outliers <- data[-outlier.indices,]
for (M.estimator in names(M.estimators)) {
M.phi <- M.estimators[[M.estimator]]
if (M.estimator == "least.abs.dev") {
# least absolute deviation requires a different function to fit the model
model <- rq(arr_delay ~ ., data = data)
} else {
model <- rlm(arr_delay ~ ., data = data, psi = M.phi)
}
metric <- mad(model$residuals) # mean absolute deviation
params <- summary(model)$coef
print(paste(M.estimator, metric, sep = ": "))
print(params)
}
for (M.estimator in names(M.estimators)) {
M.phi <- M.estimators[[M.estimator]]
if (M.estimator == "least.abs.dev") {
# least absolute deviation requires a different function to fit the model
model <- rq(arr_delay ~ ., data = data.no.outliers)
} else {
model <- rlm(arr_delay ~ ., data = data.no.outliers, psi = M.phi)
}
metric <- mad(model$residuals) # mean absolute deviation
params <- summary(model)$coef
print(paste(M.estimator, metric, sep = ": "))
print(params)
}
for (M.estimator in names(M.estimators)) {
M.phi <- M.estimators[[M.estimator]]
if (M.estimator == "least.abs.dev") {
# least absolute deviation requires a different function to fit the model
model <- rq(arr_delay ~ ., data = data, method = "MM")
} else {
model <- rlm(arr_delay ~ ., data = data, psi = M.phi)
}
metric <- mad(model$residuals) # mean absolute deviation
params <- summary(model)$coef
print(paste(M.estimator, metric, sep = ": "))
print(params)
}
?rlm
model <- rlm(arr_delay ~ ., data = data, psi = M.phi, method = "MM")
for (M.estimator in names(M.estimators)) {
M.phi <- M.estimators[[M.estimator]]
if (M.estimator == "least.abs.dev") {
# least absolute deviation requires a different function to fit the model
model <- rq(arr_delay ~ ., data = data)
} else {
model <- rlm(arr_delay ~ ., data = data, psi = M.phi, method = "MM")
}
metric <- mad(model$residuals) # mean absolute deviation
params <- summary(model)$coef
print(paste(M.estimator, metric, sep = ": "))
print(params)
}
for (M.estimator in names(M.estimators)) {
M.phi <- M.estimators[[M.estimator]]
if (M.estimator == "least.abs.dev") {
# least absolute deviation requires a different function to fit the model
model <- rq(arr_delay ~ ., data = data.no.outliers)
} else {
model <- rlm(arr_delay ~ ., data = data.no.outliers, psi = M.phi)
}
metric <- mad(model$residuals) # mean absolute deviation
params <- summary(model)$coef
print(paste(M.estimator, metric, sep = ": "))
print(params)
}
for (M.estimator in names(M.estimators)) {
M.phi <- M.estimators[[M.estimator]]
if (M.estimator == "least.abs.dev") {
# least absolute deviation requires a different function to fit the model
model <- rq(arr_delay ~ ., data = data.no.outliers)
} else {
model <- rlm(arr_delay ~ ., data = data.no.outliers, psi = M.phi, method = "MM")
}
metric <- mad(model$residuals) # mean absolute deviation
params <- summary(model)$coef
print(paste(M.estimator, metric, sep = ": "))
print(params)
}
for (M.estimator in names(M.estimators)) {
M.phi <- M.estimators[[M.estimator]]
if (M.estimator == "least.abs.dev") {
# least absolute deviation requires a different function to fit the model
model <- rq(arr_delay ~ ., data = data.no.outliers)
} else {
model <- rlm(arr_delay ~ ., data = data.no.outliers, psi = M.phi)
}
metric <- mad(model$residuals) # mean absolute deviation
params <- summary(model)$coef
print(paste(M.estimator, metric, sep = ": "))
print(params)
}
for (M.estimator in names(M.estimators)) {
M.phi <- M.estimators[[M.estimator]]
if (M.estimator == "least.abs.dev") {
# least absolute deviation requires a different function to fit the model
model <- rq(arr_delay ~ ., data = data)
} else {
model <- rlm(arr_delay ~ ., data = data, psi = M.phi)
}
metric <- mad(model$residuals) # mean absolute deviation
params <- summary(model)$coef
print(paste(M.estimator, metric, sep = ": "))
print(params)
}
MADs <- list(length(M.estimators))
for (M.estimator in names(M.estimators)) {
M.phi <- M.estimators[[M.estimator]]
if (M.estimator == "least.abs.dev") {
# least absolute deviation requires a different function to fit the model
model <- rq(arr_delay ~ ., data = data)
} else {
model <- rlm(arr_delay ~ ., data = data, psi = M.phi)
}
MAD <- mad(model$residuals) # mean absolute deviation
MADs[[M.estimator]] = MAD
params <- summary(model)$coef
print(paste(M.estimator, MAD, sep = ": "))
print(params)
}
MADs
hist(MADs)
bar(MADs)
barplot(MADS)
barplot(MADs)
?numeric
?append
append(MADs, MAD)
MADs <- numeric()
for (M.estimator in names(M.estimators)) {
M.phi <- M.estimators[[M.estimator]]
if (M.estimator == "least.abs.dev") {
# least absolute deviation requires a different function to fit the model
model <- rq(arr_delay ~ ., data = data)
} else {
model <- rlm(arr_delay ~ ., data = data, psi = M.phi)
}
MAD <- mad(model$residuals) # mean absolute deviation
append(MADs, MAD)
params <- summary(model)$coef
print(paste(M.estimator, MAD, sep = ": "))
print(params)
}
MADs
MADs <- append(MADs, MAD)
MADs <- numeric()
for (M.estimator in names(M.estimators)) {
M.phi <- M.estimators[[M.estimator]]
if (M.estimator == "least.abs.dev") {
# least absolute deviation requires a different function to fit the model
model <- rq(arr_delay ~ ., data = data)
} else {
model <- rlm(arr_delay ~ ., data = data, psi = M.phi)
}
MAD <- mad(model$residuals) # mean absolute deviation
MADs <- append(MADs, MAD)
params <- summary(model)$coef
print(paste(M.estimator, MAD, sep = ": "))
print(params)
}
MADs
barplot(names(M.estimators), MADs)
?barplot
barplot(MADs)
barplot(MADs, names.arg = names(M.estimator))
barplot(MADs, names.arg = names(M.estimator))
barplot(MADs, names.arg = names(M.estimators))
names(M.estimators)
barplot(MADs, names.arg = names(M.estimators))
MADs <- numeric()
for (M.estimator in names(M.estimators)) {
M.phi <- M.estimators[[M.estimator]]
if (M.estimator == "least.abs.dev") {
# least absolute deviation requires a different function to fit the model
model <- rq(arr_delay ~ ., data = data)
} else {
model <- rlm(arr_delay ~ ., data = data, psi = M.phi)
}
MAD <- mad(model$residuals) # mean absolute deviation
MADs <- append(MADs, MAD)
params <- summary(model)$coef
print(paste(M.estimator, MAD, sep = ": "))
print(params)
}
barplot(MADs, names.arg = names(M.estimators))
barplot(MADs, names.arg = names(M.estimators), ylab = "Median Absolute Deviation")
barplot(MADs, names.arg = names(M.estimators), ylab = "Median Absolute Deviation", ylim = c(0, 20))
barplot(MADs, names.arg = names(M.estimators), ylab = "Median Absolute Deviation", ylim = c(18, 20))
barplot(MADs, names.arg = names(M.estimators), ylab = "Median Absolute Deviation", ylim = c(17, 20))
0
MADs <- numeric()
for (M.estimator in names(M.estimators)) {
M.phi <- M.estimators[[M.estimator]]
if (M.estimator == "least.abs.dev") {
# least absolute deviation requires a different function to fit the model
model <- rq(arr_delay ~ ., data = data)
} else {
model <- rlm(arr_delay ~ ., data = data, psi = M.phi)
}
MAD <- mad(model$residuals) # mean absolute deviation
MADs <- append(MADs, MAD)
params <- summary(model)$coef
print(paste(M.estimator, MAD, sep = ": "))
print(params)
}
barplot(MADs, names.arg = names(M.estimators), ylab = "Median Absolute Deviation", ylim = c(0, 20))
ggplot(data = MADs)
MADs <- numeric()
for (M.estimator in names(M.estimators)) {
M.phi <- M.estimators[[M.estimator]]
if (M.estimator == "least.abs.dev") {
# least absolute deviation requires a different function to fit the model
model <- rq(arr_delay ~ ., data = data)
} else {
model <- rlm(arr_delay ~ ., data = data, psi = M.phi)
}
MAD <- mad(model$residuals) # mean absolute deviation
MADs <- append(MADs, MAD)
params <- summary(model)$coef
print(paste(M.estimator, MAD, sep = ": "))
print(params)
}
barplot(MADs, names.arg = names(M.estimators), ylab = "Median Absolute Deviation", ylim = c(0, 20))
MADs = numeric()
for (M.estimator in names(M.estimators)) {
M.phi <- M.estimators[[M.estimator]]
if (M.estimator == "least.abs.dev") {
# least absolute deviation requires a different function to fit the model
model <- rq(arr_delay ~ ., data = data.no.outliers)
} else {
model <- rlm(arr_delay ~ ., data = data.no.outliers, psi = M.phi)
}
MAD <- mad(model$residuals) # mean absolute deviation
MADs <- append(MADs, MAD)
params <- summary(model)$coef
print(paste(M.estimator, MAD, sep = ": "))
print(params)
}
barplot(MADs, names.arg = names(M.estimators), ylab = "Median Absolute Deviation", ylim = c(0, 20))
barplot(MADs, names.arg = names(M.estimators), ylab = "Median Absolute Deviation", ylim = c(18, 20))
barplot(MADs, names.arg = names(M.estimators), ylab = "Median Absolute Deviation", ylim = c(18, 19))
barplot(MADs, names.arg = names(M.estimators), ylab = "Median Absolute Deviation", ylim = c(17, 19))
barplot(MADs, names.arg = names(M.estimators), ylab = "Median Absolute Deviation", ylim = c(18, 19))
MADs = numeric()
for (M.estimator in names(M.estimators)) {
M.phi <- M.estimators[[M.estimator]]
if (M.estimator == "least.abs.dev") {
# least absolute deviation requires a different function to fit the model
model <- rq(arr_delay ~ ., data = data.no.outliers)
} else {
model <- rlm(arr_delay ~ ., data = data.no.outliers, psi = M.phi)
}
MAD <- mad(model$residuals) # mean absolute deviation
MADs <- append(MADs, MAD)
params <- summary(model)$coef
print(paste(M.estimator, MAD, sep = ": "))
print(params)
}
barplot(MADs, names.arg = names(M.estimators), ylab = "Median Absolute Deviation", ylim = c(18, 19))
MADs <- numeric()
for (M.estimator in names(M.estimators)) {
M.phi <- M.estimators[[M.estimator]]
if (M.estimator == "least.abs.dev") {
# least absolute deviation requires a different function to fit the model
model <- rq(arr_delay ~ ., data = data)
} else {
model <- rlm(arr_delay ~ ., data = data, psi = M.phi)
}
MAD <- mad(model$residuals) # mean absolute deviation
MADs <- append(MADs, MAD)
params <- summary(model)$coef
print(paste(M.estimator, MAD, sep = ": "))
print(params)
}
barplot(MADs, names.arg = names(M.estimators), ylab = "Median Absolute Deviation", ylim = c(18, 19))
MADs <- numeric()
for (M.estimator in names(M.estimators)) {
M.phi <- M.estimators[[M.estimator]]
if (M.estimator == "least.abs.dev") {
# least absolute deviation requires a different function to fit the model
model <- rq(arr_delay ~ ., data = data)
} else {
model <- rlm(arr_delay ~ ., data = data, psi = M.phi)
}
MAD <- mad(model$residuals) # mean absolute deviation
MADs <- append(MADs, MAD)
params <- summary(model)$coef
print(paste(M.estimator, MAD, sep = ": "))
print(params)
}
barplot(MADs, names.arg = names(M.estimators), ylab = "Median Absolute Deviation", ylim = c(18, 20))
MADs <- numeric()
for (M.estimator in names(M.estimators)) {
M.phi <- M.estimators[[M.estimator]]
if (M.estimator == "least.abs.dev") {
# least absolute deviation requires a different function to fit the model
model <- rq(arr_delay ~ ., data = data)
} else {
model <- rlm(arr_delay ~ ., data = data, psi = M.phi)
}
MAD <- mad(model$residuals) # mean absolute deviation
MADs <- append(MADs, MAD)
params <- summary(model)$coef
print(paste(M.estimator, MAD, sep = ": "))
print(params)
}
barplot(MADs, names.arg = names(M.estimators), ylab = "Median Absolute Deviation", ylim = c(18, 19.5))
m = lm(arr_delay ~ ., data = data)
summary(m)
m = lm(arr_delay ~ ., data = data.no.outliers)
summary(m)
formals(psi.andrew)
